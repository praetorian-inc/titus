# pkg/validator/validators/codacy.yaml
# NOTE: Rules using this validator must define named capture groups in their regex patterns.
# Expected named group: "token" (e.g., pattern: (?P<token>[0-9A-Z]{20,24}))
validators:
  - name: codacy-api-key
    rule_ids:
      - kingfisher.codacy.1
    http:
      method: GET
      url: https://app.codacy.com/api/v3/user/organizations
      headers:
        - name: Accept
          value: application/json
      auth:
        type: api-token
        header: api-token
        secret_group: token  # Named capture group from regex pattern
      success_codes: [200]
      failure_codes: [401, 403]
