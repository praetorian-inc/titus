# pkg/validator/validators/npm.yaml
# NPM Access Token Validator
# Validates npm_* fine-grained tokens against npm registry

validators:

- name: npm-access-token
  rule_ids:
    - np.npm.1

  http:
    method: GET
    url: "https://registry.npmjs.org/-/npm/v1/user"
    auth:
      type: bearer
      secret_group: "1"

    # Success codes indicate valid token
    success_codes: [200]

    # Failure codes indicate invalid or unauthorized token
    failure_codes: [401, 403]
