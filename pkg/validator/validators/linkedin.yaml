# pkg/validator/validators/linkedin.yaml
# NOTE: Rules using this validator must define named capture groups in their regex patterns.
# Expected named group: "access_token" (e.g., pattern: (?P<access_token>AQ[A-Za-z0-9_-]{20,1024}))
validators:
  # LinkedIn Access Token validator
  # Access tokens starting with AQ can be validated via LinkedIn API /v2/me endpoint
  - name: linkedin-access-token
    rule_ids:
      - np.linkedin.3
    http:
      method: GET
      url: "https://api.linkedin.com/v2/me"
      auth:
        type: bearer
        secret_group: "access_token"
      success_codes: [200]
      failure_codes: [401, 403]
