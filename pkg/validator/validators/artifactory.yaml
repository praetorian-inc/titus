# pkg/validator/validators/artifactory.yaml
# Artifactory API Key Validator
# NOTE: Artifactory is typically self-hosted. This validator uses a generic endpoint
# that works with both JFrog Cloud and self-hosted Artifactory instances.
# The system/ping endpoint is available on all Artifactory installations.

validators:
  - name: artifactory-api-key
    rule_ids:
      - np.artifactory.1

    http:
      method: GET
      # System ping endpoint - available on all Artifactory instances
      # For self-hosted: https://your-artifactory-host.com/artifactory/api/system/ping
      # For JFrog Cloud: https://your-instance.jfrog.io/artifactory/api/system/ping
      url: "https://artifactory.example.com/artifactory/api/system/ping"

      auth:
        type: header
        header_name: X-JFrog-Art-Api
        secret_group: "token"  # Matches (?P<token>...) in rule regex

      # Success codes indicate valid API key
      success_codes: [200]

      # Failure codes indicate invalid or unauthorized key
      failure_codes: [401, 403]
