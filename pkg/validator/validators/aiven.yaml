# pkg/validator/validators/aiven.yaml
# Aiven API Key validation
# Aiven uses custom "aivenv1" authorization scheme
# API endpoint returns project membership information for valid keys
#
# NOTE: Rules using this validator must define named capture groups in their regex patterns.
# Expected named group: "token" (e.g., pattern: (?P<token>[a-z0-9/+=]{372}))
#
# Reference: https://aiven.io/docs/tools/api
validators:
  - name: aiven-api-key
    rule_ids:
      - kingfisher.aiven.1
    http:
      method: GET
      url: https://api.aiven.io/v1/project
      auth:
        type: none  # Using custom header instead of standard bearer
        secret_group: token
      headers:
        - name: Authorization
          value: "aivenv1 {{token}}"
      success_codes: [200]
      failure_codes: [401, 403]
