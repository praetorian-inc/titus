rules:

- name: WakaTime API Key
  id: np.wakatime.1

  pattern: |
    (?xi)
    (?:wakatime|waka_time|WAKATIME)
    (?:.|[\n\r]){0,32}?
    (?:KEY|TOKEN|SECRET|API)
    (?:.|[\n\r]){0,16}?
    \b
    (?P<key>
      [0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}
    )
    \b

  min_entropy: 3.0
  confidence: medium

  categories:
  - api
  - secret

  examples:
  - "WAKATIME_API_KEY=a1b2c3d4-e5f6-7890-abcd-ef1234567890"
  - 'wakatime_api_key: "d4e5f6a7-b8c9-0123-4567-89abcdef0123"'
  - "export WAKATIME_API_KEY=f9e8d7c6-b5a4-3210-fedc-ba9876543210"

  negative_examples:
  - "WAKATIME_API_KEY=your-key-here"
  - "WAKATIME_API_KEY=00000000-0000-0000-0000-000000000000"
  - "wakatime_api_key=abcd-1234"

  description: |
    WakaTime API Key used to access developer time-tracking data.
    An attacker with this credential can access coding activity metrics,
    project names, language usage statistics, editor and OS details,
    and daily/weekly time reports for the associated developer account.

  references:
  - https://wakatime.com/developers

- name: WakaTime Prefixed API Key
  id: np.wakatime.2

  pattern: '(?i)\b(?P<key>waka_[a-z0-9]{36,})\b'

  categories:
  - api
  - secret

  examples:
  - "WAKATIME_API_KEY=waka_a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8"
  - 'api_key: "waka_f9e8d7c6b5a4321098765abcdef012345678"'

  negative_examples:
  - "waka_short"
  - "waka_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
  - "WAKATIME_API_KEY=your-key-here"

  description: |
    WakaTime API Key with waka_ prefix for developer time-tracking.
    An attacker with this credential can access coding activity metrics,
    project names, language usage statistics, and time reports.

  references:
  - https://wakatime.com/developers
