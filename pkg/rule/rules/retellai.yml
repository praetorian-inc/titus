rules:
  - name: Retell AI API Key
    id: kingfisher.retellai.api_key.1
    pattern: |
      (?xi)
      \b
      (
        key_[0-9a-f]{28}
      )
      \b
    min_entropy: 3.0
    confidence: medium
    examples:
      - key_8c08a175a1bf29f79d6bd4b125bc
      - key_08f00bd7c1fec315592048630f87
      - key_b15e562e497dce7ea90d1ba6a016
    categories:
      - api
      - secret
    references:
      - https://docs.retellai.com/accounts/api-keys-overview
      - https://docs.retellai.com/api-references/get-concurrency

    validation:
      type: Http
      content:
        request:
          method: GET
          url: https://api.retellai.com/get-concurrency
          headers:
            Accept: application/json
            Authorization: "Bearer {{ TOKEN }}"
          response_matcher:
            - report_response: true
            - type: StatusMatch
              status: [200]
            - type: JsonValid
            - type: WordMatch
              words:
                - '"current_concurrency"'
                - '"concurrency_limit"'
              match_all_words: true
