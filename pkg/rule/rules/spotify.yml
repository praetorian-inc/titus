rules:

- name: Spotify Access Token
  id: np.spotify.1

  pattern: |
    (?xi)
    (?:spotify)
    (?:.|[\n\r]){0,32}?
    (?:TOKEN|ACCESS|SECRET|KEY|BEARER|AUTH)
    (?:.|[\n\r]){0,16}?
    \b
    (?P<token>
      [A-Za-z0-9_-]{100,}
    )
    \b

  pattern_requirements:
    min_digits: 3
  min_entropy: 4.0
  confidence: medium

  categories:
  - api
  - secret

  examples:
  - "SPOTIFY_ACCESS_TOKEN=BQDj7MZaK9hP2xLvN4tR8wY0fGcE3iAoU6sBnDk1mXpJqWrT5zVuHyOlCeFgAbKdIjMnPqRsTuVwXyZaBcDeFgHiJkLmNoPqRsTuVwXyZ12345"
  - 'spotify_token: "BQAf8kL2mN4pR6tV8xZ0bD2fH4jL6nP8rT0vX2zA4cE6gI8kM0oQ2sU4wY6aB8dF0hJ2lN4pR6tV8xZ0bD2fH4jL6nP8rT0vX2zA4cE6gI8k"'

  negative_examples:
  - "SPOTIFY_ACCESS_TOKEN=short-token"
  - "spotify_token=your-token-here"
  - "SPOTIFY_ACCESS_TOKEN=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"

  description: |
    Spotify OAuth Access Token used to access the Spotify Web API.
    An attacker with this credential can access the user's Spotify account
    including listening history, playlists, saved tracks, profile information,
    and depending on scopes, may be able to modify playlists and playback.

  references:
  - https://developer.spotify.com/documentation/web-api/
