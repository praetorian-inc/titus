rules:
  - name: Alchemy API Key
    id: kingfisher.alchemy.1
    pattern: |
      (?xi)
      \balchemy
      (?:.|[\n\r]){0,96}?
      (?:
        /v2/
        |
        api[_-]?key|key|token|secret|url|endpoint|rpc
      )
      (?:.|[\n\r]){0,96}?
      \b
      (
        [A-Za-z0-9_-]{24,64}
      )
      \b
    pattern_requirements:
      min_digits: 4
    min_entropy: 3.5
    confidence: medium
    examples:
      - alchemy_key="PajdHzB75s1V_7aldcQ6XbodqDCWMC7m"
      - https://eth-mainnet.alchemyapi.io/v2/PajdHzB75s1V_7aldcQ6XbodqDCWMC7m
      - https://eth-goerli.alchemyapi.io/v2/AGtF3w2AsccY_bfsdDleaVRehW2xGS7W
    references:
      - https://www.alchemy.com/rpc/ethereum
      - https://www.alchemy.com/docs/reference/nft-api-endpoints/nft-api-endpoints/nft-ownership-endpoints/get-nf-ts-for-owner-v-3
    validation:
      type: Http
      content:
        request:
          method: GET
          url: "https://eth-mainnet.g.alchemy.com/nft/v3/{{ TOKEN }}/getNFTsForOwner?owner=0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045"
          headers:
            Accept: application/json
          response_matcher:
            - report_response: true
            - type: StatusMatch
              status: [200]
            - type: WordMatch
              words: ['"ownedNfts"']
            - type: WordMatch
              negative: true
              words: ['"error"']
