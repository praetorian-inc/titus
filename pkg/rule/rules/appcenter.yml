rules:

- name: Visual Studio App Center API Token
  id: np.appcenter.1

  pattern: |
    (?xi)
    (?:appcenter|app[_-]?center)
    (?:.|[\n\r]){0,32}?
    (?:API|TOKEN|KEY|SECRET)
    (?:.|[\n\r]){0,16}?
    \b
    (?P<token>
      [a-f0-9]{40}
    )
    \b

  pattern_requirements:
    min_digits: 3
  min_entropy: 3.0
  confidence: medium

  categories:
  - api
  - secret

  examples:
  - "APPCENTER_API_TOKEN=a3b8f29e4d1c6a0578e23d9f41b6c8e201234567"
  - 'app_center_token: "9f4b2d7e1a3c8056d2e7f1b94a6c3d8001234567"'
  - "export APP_CENTER_KEY=d4e8f2a7b1c39605d2e7f1b94a6c3d8001234567"

  negative_examples:
  - "APPCENTER_API_TOKEN=abcdef1234"
  - "app_center_token=your-token-here"
  - "APPCENTER_API_TOKEN=0000000000000000000000000000000000000000"

  description: |
    Visual Studio App Center API Token used to access mobile app build,
    test, and distribution services. An attacker with this credential
    can access app builds, download release artifacts, view crash reports,
    and manage app distribution groups.

  references:
  - https://openapi.appcenter.ms/
