rules:
  - name: Cursor Integrations (User) API Key
    id: kingfisher.cursor.1
    pattern: |
      (?xi)
      \b
      (
        key_
        [0-9a-f]{64}
      )
      \b
    min_entropy: 3.8
    confidence: medium
    examples:
      - key_8c5a7657fc397e114def1b51dd520410ad50ece61e30b64261ff369ab275ef29
      - key_86aed0092d14dd6aae4e8ad107d52f760c5efa4bc3753730ca6983babc2b1072
      - key_d9ba91e29d81f1bf2085b55b06f5ac43885749005cff565bee7f406ca2e2f3f9
    references:
      - https://cursor.com/docs/cloud-agent/api/endpoints
    validation:
      type: Http
      content:
        request:
          method: GET
          url: https://api.cursor.com/v0/me
          headers:
            Accept: application/json
            Authorization: 'Basic {{ TOKEN | b64enc }}'
          response_matcher:
            - report_response: true
            - type: WordMatch
              words: ['"userEmail"']
