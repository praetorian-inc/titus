rules:

- name: Calendly Personal Access Token
  id: np.calendly.1

  pattern: |
    (?xi)
    (?:calendly)
    (?:.|[\n\r]){0,32}?
    (?:API|TOKEN|KEY|SECRET|BEARER|PAT|AUTH)
    (?:.|[\n\r]){0,16}?
    (?P<token>
      eyJ[A-Za-z0-9_-]{30,}
      \.
      eyJ[A-Za-z0-9_-]{30,}
      \.
      [A-Za-z0-9_-]{20,}
    )

  categories:
  - api
  - secret

  examples:
  - 'CALENDLY_TOKEN=eyJraWQiOiIxMjM0NTY3ODkwYWJjZGVmMDEyMzQ1Njc4OTBhYmNkZWYiLCJ0eXAiOiJQQVQiLCJhbGciOiJFUzI1NiJ9.eyJpc3MiOiJodHRwczovL2F1dGguY2FsZW5kbHkuY29tIiwiaWF0IjoxNzAwMDAwMDAwLCJ1c2VyX3V1aWQiOiIxMjM0NTY3OC1hYmNkIn0.Yz2Kx8mN4pR6tV8xZ0bD2fH4jL6nP8rT0vX2zA4cE6gIk5mQw7hJ9pL3sU1yB'
  - 'calendly_api_key: "eyJraWQiOiJhYmNkZWYwMTIzNDU2Nzg5MGFiY2RlZjAxMjM0NTY3ODkwMTIzIiwidHlwIjoiUEFUIiwiYWxnIjoiRVMyNTYifQ.eyJpc3MiOiJodHRwczovL2F1dGguY2FsZW5kbHkuY29tIiwiaWF0IjoxNzI5NDM3MDAwfQ.Rq4s5T6u7V8w9X0yZ1a2B3c4D5e6F7gH8iJ9kL0mN1oP2qR3sT4uV5wX6yZ7a"'

  negative_examples:
  - "CALENDLY_TOKEN=short-token"
  - "calendly_token=your-token-here"
  - "CALENDLY_API_KEY=a3b8f29e4d1c6a0578e23d9f41b6c8e2"
  - "eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJvdGhlci1zZXJ2aWNlIn0.signature"

  description: |
    Calendly Personal Access Token (v2 API) in JWT format used to access
    scheduling and event data. An attacker with this credential can read
    scheduled events, access invitee information, modify scheduling settings,
    and cancel or create events on behalf of the account owner.

  references:
  - https://developer.calendly.com/how-to-authenticate-with-personal-access-tokens
  - https://developer.calendly.com/api-docs
